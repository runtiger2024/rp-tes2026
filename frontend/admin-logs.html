<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <title>ç³»çµ±å¯©è¨ˆæ—¥èªŒ - å°è·‘è±¬ç‡Ÿé‹å¾Œå°</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="css/admin-modern.css" />
  </head>
  <body>
    <div id="wrapper">
      <div id="sidebar-placeholder"></div>
      <div id="content-wrapper" class="d-flex flex-column">
        <div class="container-fluid mt-4">
          <h1 class="h3 mb-4">ğŸ“œ æ“ä½œå¯©è¨ˆç´€éŒ„</h1>

          <div class="card shadow">
            <div class="card-body p-0">
              <table class="modern-table">
                <thead>
                  <tr>
                    <th>ç™¼ç”Ÿæ™‚é–“</th>
                    <th>æ“ä½œè€…</th>
                    <th>å‹•ä½œ</th>
                    <th>å°è±¡</th>
                    <th>è©³ç´°èªªæ˜</th>
                  </tr>
                </thead>
                <tbody id="logs-list"></tbody>
              </table>
            </div>
            <div class="card-footer d-flex justify-content-between">
              <button class="btn btn-sm btn-link" id="prev-logs">ä¸Šä¸€é </button>
              <span id="logs-page-info">é æ¬¡ 1</span>
              <button class="btn btn-sm btn-link" id="next-logs">ä¸‹ä¸€é </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="js/apiConfig.js"></script>
    <script type="module">
      import { adminApi } from "./src/api/admin.api.js";
      import "./js/admin-layout.js";

      document.addEventListener("DOMContentLoaded", async () => {
        const data = await adminApi.getActivityLogs();
        renderLogs(data.logs);
      });

      function renderLogs(logs) {
        const body = document.getElementById("logs-list");
        body.innerHTML = logs
          .map(
            (l) => `
          <tr>
            <td class="small">${new Date(l.createdAt).toLocaleString()}</td>
            <td><strong>${l.user?.name || "ç³»çµ±"}</strong></td>
            <td><span class="badge badge-info">${l.action}</span></td>
            <td>${l.target || "-"}</td>
            <td class="small text-muted">${JSON.stringify(l.details)}</td>
          </tr>
        `
          )
          .join("");
      }
    </script>
  </body>
</html>
